<!-- Link health -->
<div ng-controller="ConfigHealthController">
    <!-- Config navigation -->
    <div ng-include="'app/views/configuration/header.html'"></div>
    <bb-alert alert="health.alert"></bb-alert>
    <div class="tab-content" ng-show="deviceId && !_.isEmpty(health.neighbours)">
        <div id="table_mobile">
            <div class="alert ng-scope alert-warning" ng-if="!health.device.hasPowerLevel">
                <i class="fa fa-exclamation-circle"></i> {{_t('link_health_no_powerlevel')}}
            </div>
            <table class="table table-striped table-condensed table-hover">
                <thead class="cf">
                    <tr>
                        <th>
                            <a href="" ng-click="orderBy('id')">{{ _t('link_to_node')}} 
                                <span ng-show="predicate == 'id'"><i ng-show="!reverse" class="fa fa-sort-asc"></i><i ng-show="reverse" class="fa fa-sort-desc"></i></span>
                            </a>
                        </th>
                        <th>
                            <a href="" ng-click="orderBy('name')">{{ _t('device_name')}}
                                <span ng-show="predicate == 'name'"><i ng-show="!reverse" class="fa fa-sort-asc"></i><i ng-show="reverse" class="fa fa-sort-desc"></i></span>
                            </a>
                        </th>
                        <th>
                            <a href="" ng-click="orderBy('type')">{{_t('th_type')}}  
                                <span ng-show="predicate == 'type'"><i ng-show="!reverse" class="fa fa-sort-asc"></i><i ng-show="reverse" class="fa fa-sort-desc"></i></span>
                            </a>
                        </th>
                        <th>
                            <a href="" ng-click="orderBy('updateTime')">{{ _t('datetime')}}
                                <span ng-show="predicate == 'updateTime'"><i ng-show="!reverse" class="fa fa-sort-asc"></i><i ng-show="reverse" class="fa fa-sort-desc"></i></span>
                            </a>
                        </th>
                        <th>
                            <a href="" ng-click="orderBy('traffic')">{{ _t('traffic')}}
                                <span ng-show="predicate == 'traffic'"><i ng-show="!reverse" class="fa fa-sort-asc"></i><i ng-show="reverse" class="fa fa-sort-desc"></i></span>
                            </a>
                        </th>
                        <th>&nbsp;</th>
                    </tr>

                </thead>
                <tbody>
                    <tr ng-repeat="v in health.neighbours| orderBy:predicate:reverse" id="{{v.rowId}}">
                        <td data-title="#">
                            <button class="btn btn-default btn-{{v.type}}">{{ v.id}}</button>
                        </td>
                        <td data-title="{{ _t('device_name')}}">
                            {{ v.name}}
                        </td>
                        <td data-title="{{ _t('type')}}">
                            <span ng-switch="v.type" title="{{v.type}}">
                                <i class="fa fa-cog" ng-switch-when="static"></i>
                                <i class="fa fa-fire text-info" ng-switch-when="flirs"></i>
                                <i class="fa fa-bolt text-warning" ng-switch-when="mains"></i>
                                <i class="fa fa-battery-full text-success" ng-switch-when="sleep"></i>
                                <i class="fa fa-battery-full text-success" ng-switch-when="battery"></i>
                                <i ng-switch-default></i>
                                | {{v.type}}
                            </span>
                        </td>
                        <td data-title="{{ _t('datetime')}}">
                            <span class="row-time is-updated-{{v.isUpdated}}"
                                  ng-if="v.powerLevel.acknowledgedFrames.updateTime">
                                {{ v.powerLevel.acknowledgedFrames.updateTime | isTodayFromUnix }}
                            </span>
                        </td>
                        <td data-title="{{ _t('traffic')}}">
                            <i class="fa fa-dot-circle-o fa-lg clickable {{v.powerLevel.traffic}}" 
                               ng-if="v.powerLevel.traffic" 
                               ng-click="openTimingModal('healthTimingModal', $event,v)"></i>
                            <span ng-if="!v.powerLevel">---</span>
                        </td>
                        <td data-title="" ng-switch on="v.deviceType">
                            <!-- Test node -->
                            <button class="btn btn-primary" 
                                    ng-if="health.device.hasPowerLevel"
                                    ng-click="runZwaveCmd(v.cmdTestNode)">
                                {{ _t('test_link')}}</button>
                            <!-- NOP -->
                            <button class="btn btn-info" 
                                    ng-if="!health.device.hasPowerLevel && v.type === 'static'" 
                                    ng-click="runZwaveCmd(v.cmdNop)">
                                {{ _t('nop')}}</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div> 
     <!-- Modal timing --> 
    <div id="healthTimingModal" class="appmodal" ng-if="modalArr.healthTimingModal">
        <div class="appmodal-in">
            <div class="appmodal-header">
                <span class="appmodal-close" ng-click="handleModal('healthTimingModal', $event)"><i class="fa fa-times"></i></span>
                <h3>{{health.timing.find.device.name|cutText:true:30}}</h3>
            </div>
            <div class="appmodal-body">
                Modal body
            </div>
            <div class="appmodal-footer">
                <!-- Close --> 
                <button type="button" class="btn btn-default" ng-click="handleModal('iconOnlineModal', $event)">
                    <i class="fa fa-times text-danger"></i> <span class="btn-name">{{_t('lb_close')}}</span>
                </button>
                <!-- Download --> 
                <button href="" class="btn btn-submit" title="{{_t('lb_download')}}" 
                       ng-click="handleModal('iconOnlineModal', $event);downloadIconSet(iconsOnline.find)">
                    <i class="fa fa-download"></i> <span class="btn-name">{{_t('lb_download')}}</span>
                </button>
        </div>
        </div>
    </div>

</div><!-- /ng-controler -->
