<!-- Help view -->
<div ng-controller="ZnifferController">
    <div class="page-header"><h1>{{ _t('nav_zniffer')}}</h1></div>
    <div class="page-control form-inline">
        <div class="row">
            <div class="col-md-6">
                Other stuff
            </div>
            <div class="col-md-6 text-right">
                <div class="form-group">
                    <div class="btn-group">
                        <button class="btn btn-default" ng-click="expandFilter('znifferFilter', $event)">
                            <i class="fa fa-filter"></i> 
                            <span class="btn-name"></span>
                        </button>
                        <button class="btn btn-default" ng-click="expandFilter('znifferFilter', $event)" ng-if="zniffer.filter.model">
                            <span class="btn-name">{{zniffer.filter.model| cutText:true:15}}</span> <i class="fa fa-caret-down"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group">
                        <input name="add_tag" id="add_tag" type="text" class="form-control" placeholder="{{_t('lb_add_tag')}}" 
                               ng-model="zniffer.filter.search" 
                               bb-key-event="searchZniffer()"
                               ng-focus="expandFilter('znifferFilter', $event, false)"
                               ng-disabled="!zniffer.filter.model" />
                        <div class="app-dropdown" ng-if="zniffer.filter.suggestions.length">
                            <ul>
                                <li href="" ng-click="applyZnifferFilter(v)" 
                                    ng-repeat="v in  zniffer.filter.suggestions| orderBy:'toString()'"><a href=""> <i class="fa fa-plus text-success"></i> {{v}}</a></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!--<input type="text" ng-model="q" class="form-control form-search" value="{{q}}">
                <span class="input-group-addon"><i class="fa fa-search"></i></span>--> 
            </div>
        </div>

    </div>

    <!-- Page subnavi filter -->
    <div class="page-navi" ng-if="filterExpanded.znifferFilter">
        <div class="page-navi-in">
            <div class="navi-overflow">
                <div class="page-navi-content">
                    <button class="btn btn-default btn-tag"
                            ng-repeat="v in zniffer.filter.items"
                            ng-click="setZnifferFilter(v)"
                            ng-class="zniffer.filter.model === v ? 'active' : ''">
                        {{v}}
                    </button>
                    <button class="btn btn-default btn-tag"
                            ng-click="resetZnifferFilter(); expandFilter('znifferFilter', $event)"
                            ng-class="!zniffer.filter.model ? 'active' : ''">
                        <i class="fa fa-times text-danger"></i> {{_t('reset_filter')}}
                    </button>
                </div>
                <ul>
                    <li ng-repeat="(v,k) in zniffer.filter.data[zniffer.filter.model]">
                        <a href="" ng-click="applyZnifferFilter(v);expandFilter('znifferFilter', $event)"> 
                            {{v| cutText:true:30}} <span class="item-cnt">({{k}})</span> 
                            <span class="page-navi-icon"><i class="fa fa-chevron-right"></i></span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="appnavi-footer clickable" ng-click="expandFilter('znifferFilter', $event)">
                <span class="clickable">
                    <i class="fa fa-times text-danger"></i></span>
            </div>
        </div>
    </div>
    <div id="table_mobile">
        <table class="table table-condensed table-hover">
            <thead>
                <tr>
                    <th>
                        <a href="" ng-click="orderBy('timestamp')">{{ _t('timestamp')}} 
                            <span ng-show="predicate == 'timestamp'"><i ng-show="!reverse" class="fa fa-sort-asc"></i><i ng-show="reverse" class="fa fa-sort-desc"></i></span>
                        </a>
                    </th>
                    <th>
                        <a href="" ng-click="orderBy('speed')">{{ _t('speed')}}  
                            <span ng-show="predicate == 'speed'"><i ng-show="!reverse" class="fa fa-sort-asc"></i><i ng-show="reverse" class="fa fa-sort-desc"></i></span>
                        </a>
                    </th>
                    <th>
                        <a href="" ng-click="orderBy('rssi')">{{ _t('rssi')}}   
                            <span ng-show="predicate == 'rssi'"><i ng-show="!reverse" class="fa fa-sort-asc"></i><i ng-show="reverse" class="fa fa-sort-desc"></i></span>
                        </a>
                    </th>
                    <th>
                        <a href="" ng-click="orderBy('src')">{{ _t('src')}}   
                            <span ng-show="predicate == 'src'"><i ng-show="!reverse" class="fa fa-sort-asc"></i><i ng-show="reverse" class="fa fa-sort-desc"></i></span>
                        </a>
                    </th>
                    <th>
                        <a href="" ng-click="orderBy('dest')">{{ _t('dest')}}  
                            <span ng-show="predicate == 'dest'"><i ng-show="!reverse" class="fa fa-sort-asc"></i><i ng-show="reverse" class="fa fa-sort-desc"></i></span>
                        </a>
                    </th>
                    <th>
                        <div class="input-group">
                            <!-- Title and filter -->
                            <a class="clickable"
                               ng-class="zniffer.filter.model === 'homeid' ? 'text-success' : ''"
                               ng-click="setZnifferFilter('homeid');expandNavi('znifferFilterHomeid', $event)">
                                <i class="fa fa-filter"></i> {{ _t('homeid')}}
                            </a>
                            <!-- Sorting -->
                            <span class="clickable" ng-click="orderBy('homeid')"><i ng-show="!reverse" class="fa fa-sort-asc"></i><i ng-show="reverse" class="fa fa-sort-desc"></i></span>
                            <!-- Drop down -->
                            <div class="app-dropdown" ng-if="naviExpanded.znifferFilterHomeid">
                                 <ul>
                                <li ng-repeat="(v,k) in zniffer.filter.data['homeid']"
                                    ng-class="v === zniffer.filter.search ? 'active':''"
                                    ng-click="applyZnifferFilter(v)">
                                    <a href="">{{v}} <span class="menu-arrow" ng-if="v === zniffer.filter.search">
                                            <i class="fa fa-check"></i></span>
                                    </a>
                                    
                                </li>
                                </ul>
                            </div>
                        </div>
                    </th>
                    <th>
                        <a href="" ng-click="orderBy('data_txt')">{{ _t('data')}}   
                            <span ng-show="predicate == 'data_txt'"><i ng-show="!reverse" class="fa fa-sort-asc"></i><i ng-show="reverse" class="fa fa-sort-desc"></i></span>
                        </a>
                    </th>
                    <th>{{ _t('pakettype')}}</th>
                    <th>{{ _t('hexdata')}}</th>
                </tr>
            </thead>
            <tbody>
                <tr class="zniffer_row_{{v.data}}" ng-repeat="v in zniffer.all| orderBy:predicate:reverse | filter:q" id="{{$index}}">
                    <td>{{v.timestamp}}</td>
                    <td>{{v.speed}}Kbit/s</td>
                    <td>{{v.rssi}}</td>
                    <td>{{v.src}}</td>
                    <td>{{v.dest}}</td>
                    <td ng-class="zniffer.filter.model === 'homeid' ? 'bcg-success' : ''">{{v.homeid}}</td>
                    <td>{{v.data_txt}}</td>
                    <td>{{v.pakettype}}</td>
                    <td>{{v.hexdata}}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>